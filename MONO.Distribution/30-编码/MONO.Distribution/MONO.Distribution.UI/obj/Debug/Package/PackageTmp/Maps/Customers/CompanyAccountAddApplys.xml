<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="CompanyAccountAddApplys" xmlns="http://ibatis.apache.org/mapping" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <!--实体类映射-->
  <alias>
    <typeAlias alias="CompanyAccountAddApplys" type="MONO.Distribution.Model.Customers.CompanyAccountAddApplys,MONO.Distribution.Model"/>
  </alias>

  <!--字段对应-->
  <resultMaps>
    <resultMap id="CompanyAccountAddApplysResult" class="CompanyAccountAddApplys">
      <result property="AccountAddApplyKey" column="AccountAddApplyKey"/>
      <result property="CompanyKey" column="CompanyKey"/>
      <result property="SysUserKey" column="SysUserKey"/>
      <result property="Remark" column="Remark"/>
      <result property="CreateTime" column="CreateTime"/>
      <result property="AccountIntegrel" column="AccountIntegrel"/>
      <result property="ApplyStatus" column="ApplyStatus"/>
      <result property="AccountApplyAttses" column="AccountAddApplyKey" select="SelectAccountApplyAttsByParentKey" lazyLoad="false"/>
      <result property="BeApplyUser" column="CompanyKey" select="SelectSystemUserByKey" lazyLoad="false"/>
      <result property="ApplyUser" column="SysUserKey" select="SelectSystemUserByKey" lazyLoad="false"/>
      <result property="EnumStatus" column="ApplyStatus" select="SelectEnumerationByKey" lazyLoad="false"/>
    </resultMap>
  </resultMaps>

  <!--动态sql语句-->
  <statements>

    <insert id='InsertCompanyAccountAddApplys' parameterClass='CompanyAccountAddApplys'>
      INSERT INTO FD_CompanyAccountAddApplys
      (
      CompanyKey,
      SysUserKey,
      CreateTime,
      AccountIntegrel,
      Remark,
      ApplyStatus
      )
      VALUES
      (
      #CompanyKey#,
      #SysUserKey#,
      GetDate(),
      #AccountIntegrel#,
      #Remark#,
      #ApplyStatus#
      <selectKey property="AccountAddApplyKey" resultClass="int" type="post"> SELECT cast(@@IDENTITY as int) AS id </selectKey>
      )
    </insert>


    <update id='UpdateCompanyAccountAddApplys' parameterClass='CompanyAccountAddApplys'>
      UPDATE FD_CompanyAccountAddApplys
      SET AccountIntegrel=#AccountIntegrel#
      <isNotEmpty prepend=',' property='ApplyStatus'>
        ApplyStatus=#ApplyStatus#
      </isNotEmpty>
      WHERE
      [AccountAddApplyKey] = #AccountAddApplyKey#
    </update>

    <delete id='DeleteCompanyAccountAddApplys' parameterClass='CompanyAccountAddApplys'>
      DELETE FROM FD_CompanyAccountAddApplys
      WHERE
      [AccountAddApplyKey] = #AccountAddApplyKey#
    </delete>



    <select id="SelectCompanyAccountAddApplysList" parameterClass="CompanyAccountAddApplys"   resultMap="CompanyAccountAddApplysResult">
      <![CDATA[SELECT 
         AccountAddApplyKey,
         CompanyKey,          
        SysUserKey,
         CreateTime,         
         AccountIntegrel,
         Remark,
         ApplyStatus
        ]]>
      <dynamic prepend="">
        <isEqual prepend="" property="IsStartPager" compareValue="true">
          FROM (SELECT ROW_NUMBER() OVER(ORDER BY CreateTime DESC) AS RowNumber,
          * FROM FD_CompanyAccountAddApplys
          WHERE 1=1
          <isGreaterThan prepend="AND" compareValue="0" property="CompanyKey"> CompanyKey=#CompanyKey#</isGreaterThan>
          <isNotEmpty prepend="AND" property="Remark"> Remark like '%'+#Remark#+'%'</isNotEmpty>

          )T
        </isEqual>

        <isEqual prepend="" property="IsStartPager" compareValue="false">
          FROM FD_CompanyAccountAddApplys
        </isEqual>
      </dynamic>
      where 1=1
      <dynamic >
        <isGreaterThan prepend="AND" compareValue="0" property="CompanyKey"> CompanyKey=#CompanyKey#</isGreaterThan>
        <isNotEmpty prepend="AND" property="Remark"> Remark like '%'+#Remark#+'%'</isNotEmpty>

        <isGreaterThan prepend="AND" property="StartRecordIndex" compareValue="0">
          <![CDATA[RowNumber>=#StartRecordIndex#]]>
        </isGreaterThan>
        <isGreaterThan prepend="AND" property="EndRecordIndex" compareValue="0">
          <![CDATA[RowNumber<=#EndRecordIndex#]]>
        </isGreaterThan>
      </dynamic>
    </select>

    <select id="SelectCompanyAccountAddApplysCount" parameterClass="CompanyAccountAddApplys" resultClass="int">
      Select count(*)
      FROM FD_CompanyAccountAddApplys buy

      WHERE 1=1
      <dynamic >
        <isGreaterThan prepend="AND" compareValue="0" property="CompanyKey"> CompanyKey=#CompanyKey#</isGreaterThan>
        <isNotEmpty prepend="AND" property="Remark"> Remark like '%'+#Remark#+'%'</isNotEmpty>

      </dynamic>
    </select>


    <select id="SelectCompanyAccountAddApplysByKey" parameterClass="CompanyAccountAddApplys"  resultMap="CompanyAccountAddApplysResult">
      Select
      AccountAddApplyKey,
      CompanyKey,
      SysUserKey,
      CreateTime,
      AccountIntegrel,
      Remark,
      ApplyStatus
      FROM FD_CompanyAccountAddApplys
      WHERE AccountAddApplyKey=#AccountAddApplyKey#
    </select>


  </statements>
</sqlMap>
